<!DOCTYPE html>
<html>
<head>
<title>Tickera App</title>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/validate.js"></script>
<script type="text/javascript">
function appReady(){  
       jQuery("#infodiv").html("Testing JSONP with jQuery");  
     }  
   
     jQuery(document).ready(function(){  
       //jQuery("#get-name").click(function(){  
         handleClick();  
       //});  
   
       jQuery("#ajax_error").ajaxError(function(e, jqxhr, settings, exception) {  
         jQuery(this).text( "Error requesting page " + settings.url);  
       });  
     });  
   
     document.addEventListener("deviceready", appReady, false);  
   
     jQuery( document ).bind( "mobileinit", function() {  
       // Make your jQuery Mobile framework configuration changes here!  
       jQuery("#infodiv").html('mobileinit worked');  
       //jQuery.mobile.allowCrossDomainPages = true;  
     });  
   
     function handleClick(){  
      // var url = 'http://fineglasswork.com/histmarkers/client/partial.php';  
   		var siteurl=jQuery('#siteurl').val();
		var apikey='wtseat';
		//window.location='tickets.html?siteurl='+siteurl+'&apikey='+apikey;
		var url = siteurl+'/wp-admin/admin-ajax.php';  
       jQuery.ajax({  
         type: 'GET',  
         url: url,  
         contentType: "application/json",  
         dataType: 'jsonp',  
         data: {first: 'Rinku', last: 'Kamboj' },  
         crossDomain: true,  
         success: function(res) {  
           //jQuery("#resultsdiv").html("Hello, " + res.firstname + " " + res.lastname);  
           //console.dir(res.fullname);  
         },  
         error: function(e, d, a){
            alert('resp='+e.message +', dd='+ d + ', aa='+a) ;  
         },  
         complete: function(data) {  
           //console.log(e.message);  
         }  
       });  
   
     } 
jQuery(document).ready(function(){

	jQuery( document ).on( "mobileinit", function() {
		// Make your jQuery Mobile framework configuration changes here!
	
		jQuery.mobile.allowCrossDomainPages = true;
	});
	var contentType ="application/x-www-form-urlencoded; charset=utf-8";
 
    if(window.XDomainRequest){contentType = "text/plain";}
	jQuery.support.cors = true;
    jQuery("#signin").click(function()
    {
		
		var siteurl=jQuery('#siteurl').val();
		var apikey=jQuery('#apikey').val();
		//window.location='tickets.html?siteurl='+siteurl+'&apikey='+apikey;
		var url = siteurl+'/wp-admin/admin-ajax.php';  
   
       jQuery.ajax({  
         type: 'GET',  
         url: url,  
         contentType: contentType,  
         dataType: 'json',  
         data: {apikey:apikey},  
         crossDomain: true,  
         success: function(res) {  
           alert('success');
            if(res['login']=='success')
			{
				window.location='tickets.html?siteurl='+siteurl+'&apikey='+apikey+'&event_id='+res['event_id'];
			}  
         },  
         error: function(response, d, a){
            alert('resp='+response +', dd='+ d + ', aa='+a) ;  
         },  
         complete: function(data) {  
           alert('completed');  
         }  
       });
       
 
    });
});
</script>
</head>

<body>
<div id="infodiv"></div>
   <div id="get-name"></div>
   <div id="ajax_error"></div>
   <div id="infodiv"></div>
Test 1
<form name="login" id="login">
<table width="100%" border="1">
  <tr>
    <td>Website url 2</td>
    <td><input type="text" name="siteurl" id="siteurl" value="http://lamp.staging.talentshadows.com" class="url required" /></td>
  </tr>
  <tr>
    <td>Api Key</td>
    <td><input type="text" name="apikey" id="apikey" class="required" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td><input type="button" name="signin" id="signin" value="Sign In" /></td>
  </tr>
</table>

</form>
</body>
</html>